<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEX</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <canvas id="canvas"></canvas>

    <!-- Nav Toggle (bottom-center pill) -->
    <nav class="nav-toggle" id="nav-toggle">
        <button class="nav-btn active" data-view="orb" title="Orb">
            <svg viewBox="0 0 24 24" width="16" height="16"><circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
        </button>
        <button class="nav-btn" data-view="dashboard" title="Dashboard">
            <svg viewBox="0 0 24 24" width="16" height="16"><rect x="3" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="14" y="3" width="7" height="4" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="14" y="11" width="7" height="10" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="3" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
        </button>
        <button class="nav-btn" data-view="services" title="Services">
            <svg viewBox="0 0 24 24" width="16" height="16"><circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
        </button>
        <button class="nav-btn" data-view="logs" title="Logs">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
        </button>
        <button class="nav-btn" data-view="settings" title="Settings">
            <svg viewBox="0 0 24 24" width="16" height="16"><circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
        <button class="nav-btn" id="history-toggle-btn" title="History (Ctrl+H)">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        </button>
        <button class="nav-btn" id="fullscreen-btn" title="Fullscreen (Cmd+Shift+F)">
            <svg id="fs-expand-icon" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
            <svg id="fs-shrink-icon" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" style="display:none"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
        </button>
    </nav>

    <!-- Status text -->
    <div class="status" id="status">LISTENING</div>

    <!-- Mic level indicator -->
    <div class="audio-meter" id="audio-meter">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
    </div>

    <!-- Transcript overlay -->
    <div class="transcript" id="transcript"></div>

    <!-- Command input -->
    <div class="command-bar" id="command-bar">
        <input type="text" id="command-input" placeholder="Type a command..." autocomplete="off" spellcheck="false">
    </div>

    <!-- Conversation Feed (top-left, always visible on dashboard) -->
    <div class="conversation-feed" id="conversation-feed"></div>

    <!-- Dashboard View -->
    <div class="view-overlay" id="dashboard-view">
        <div class="dashboard-grid">
            <div class="stat-card" id="card-cpu">
                <div class="stat-label">CPU</div>
                <div class="stat-value" id="stat-cpu">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-cpu"></div></div>
                <div class="stat-sub" id="sub-cpu">&mdash; cores</div>
            </div>
            <div class="stat-card" id="card-memory">
                <div class="stat-label">MEMORY</div>
                <div class="stat-value" id="stat-memory">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-memory"></div></div>
                <div class="stat-sub" id="sub-memory">&mdash; / &mdash; GB</div>
            </div>
            <div class="stat-card" id="card-disk">
                <div class="stat-label">DISK</div>
                <div class="stat-value" id="stat-disk">0%</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-disk"></div></div>
                <div class="stat-sub" id="sub-disk">&mdash; / &mdash; GB</div>
            </div>
            <div class="stat-card" id="card-battery">
                <div class="stat-label">BATTERY</div>
                <div class="stat-value" id="stat-battery">&mdash;</div>
                <div class="stat-bar"><div class="stat-bar-fill" id="bar-battery"></div></div>
                <div class="stat-sub" id="sub-battery">&mdash;</div>
            </div>
            <div class="stat-card wide" id="card-network">
                <div class="stat-label">NETWORK</div>
                <div class="stat-value" id="stat-network">&mdash; / &mdash;</div>
                <div class="stat-sub" id="sub-network">sent / received</div>
            </div>
        </div>
        <div class="transcript-panel">
            <div class="panel-label">RECENT</div>
            <div class="transcript-list" id="dashboard-transcript"></div>
        </div>
    </div>

    <!-- Services View -->
    <div class="view-overlay" id="services-view">
        <div class="view-title">SERVICES</div>
        <div class="services-list" id="services-list">
            <div class="services-loading">Loading modules...</div>
        </div>
    </div>

    <!-- Logs View -->
    <div class="view-overlay" id="logs-view">
        <div class="logs-header">
            <div class="view-title">LOGS</div>
            <select id="log-filter" class="log-filter-select">
                <option value="all">All</option>
                <option value="system.command">Commands</option>
                <option value="tool.executing">Tools</option>
                <option value="system.ready">System</option>
                <option value="command.response">Responses</option>
            </select>
        </div>
        <div class="logs-scroll" id="logs-scroll">
            <div id="logs-body"></div>
        </div>
    </div>

    <!-- Settings View -->
    <div class="view-overlay" id="settings-view">
        <div class="settings-panel">
            <h2 class="settings-title">SETTINGS</h2>

            <div class="settings-group">
                <label class="settings-label">Memory</label>
                <div class="settings-row">
                    <button id="memory-view" class="settings-btn">View Memories</button>
                    <button id="memory-clear" class="settings-btn danger">Clear All</button>
                </div>
                <div id="memory-output" class="memory-output"></div>
            </div>

            <div class="settings-group">
                <label class="settings-label">Voice Authentication</label>
                <div class="settings-row">
                    <span id="voice-auth-status" class="settings-sub">Checking...</span>
                </div>
                <div class="settings-row">
                    <button id="voice-enroll" class="settings-btn">Enroll Voice</button>
                    <button id="voice-reset" class="settings-btn danger">Reset</button>
                </div>
            </div>

            <div class="settings-group">
                <label class="settings-label">User</label>
                <div class="settings-row">
                    <input type="text" id="user-name-input" class="settings-input" placeholder="Your name">
                    <button id="user-name-save" class="settings-btn">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- History Drawer -->
    <div class="history-drawer" id="history-drawer">
        <div class="history-header">
            <span class="history-title">PROMPT HISTORY</span>
            <button class="history-close" id="history-close">&times;</button>
        </div>
        <div class="history-search">
            <input type="text" id="history-search-input" placeholder="Search history..." autocomplete="off" spellcheck="false">
        </div>
        <div class="history-list" id="history-list"></div>
        <div class="history-footer" id="history-footer">
            <span id="history-stats">No history</span>
            <button class="history-clear-btn" id="history-clear">Clear All History</button>
        </div>
    </div>
    <div class="history-backdrop" id="history-backdrop"></div>

    <script src="js/nex-orb.js"></script>
    <script src="js/nex-dashboard.js"></script>
    <script src="js/nex-services.js"></script>
    <script src="js/nex-logs.js"></script>
    <script src="js/nex-settings.js"></script>
    <script src="js/nex-conversation.js"></script>
    <script src="js/nex-history.js"></script>
</body>
</html>
